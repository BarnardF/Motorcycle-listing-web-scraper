<!DOCTYPE HTML>
<html>
<head>
    <title>Motorcycle Listings Tracker</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,100italic,300italic" rel="stylesheet">
</head>

<body>
    <section class="wrapper">
        <div class="container">
            <header class="major">
                <h1>üèçÔ∏è Motorcycle Listings Tracker</h1>
                <p>Tracking 13 motorcycle models across South African websites</p>
            </header>

            <!-- Compact Stats Header -->
            <div class="compact-stats">
                <div class="compact-stat">
                    <span class="compact-stat-number" id="total-listings">42</span>
                    <span class="compact-stat-label">Listings</span>
                </div>
                <div class="compact-stat">
                    <span class="compact-stat-number">13</span>
                    <span class="compact-stat-label">Bikes</span>
                </div>
                <div class="compact-stat">
                    <span class="compact-stat-number">2</span>
                    <span class="compact-stat-label">Sources</span>
                </div>
                <div class="compact-stat">
                    <span class="compact-stat-number">7</span>
                    <span class="compact-stat-label">Price Drops</span>
                </div>
            </div>

            <!-- Control Bar (View toggles + Filters) -->
            <div class="control-bar">
                <!-- Filter Buttons -->
                <div class="filter-controls">
                    <button class="filter-btn" onclick="toggleFilterPanel('sources')">Sources</button>
                    <button class="filter-btn" onclick="toggleFilterPanel('price')">Price Range</button>
                    <button class="filter-btn" onclick="toggleFilterPanel('km')">Kilometers</button>
                    <button class="filter-btn" onclick="toggleFilterPanel('sort')">Sort By</button>
                    <button class="filter-btn clear-all" onclick="clearAllFilters()">Reset</button>
                </div>

                <!-- Results Count -->
                <div class="results-display">
                    <span id="filtered-count">42</span> / 42
                </div>
            </div>

            <!-- Collapsible Filter Panels -->
            <div class="filter-panels">
                <!-- Sources Filter -->
                <div class="filter-panel-item" id="sources-panel">
                    <div class="filter-panel-header">
                        <h4>Filter by Sources</h4>
                        <button class="filter-close-btn" onclick="toggleFilterPanel('sources')">‚úï</button>
                    </div>
                    <div class="filter-panel-content">
                        <div class="filter-checkboxes" id="source-filters">

                            <label class="checkbox-label">
                                <input type="checkbox" class="source-checkbox" value="Gumtree" checked onchange="applyFilters()">
                                <span>Gumtree</span>
                            </label>

                            <label class="checkbox-label">
                                <input type="checkbox" class="source-checkbox" value="WeBuyCars" checked onchange="applyFilters()">
                                <span>WeBuyCars</span>
                            </label>

                        </div>
                    </div>
                </div>

                <!-- Price Range Filter -->
                <div class="filter-panel-item" id="price-panel">
                    <div class="filter-panel-header">
                        <h4>Price Range (R)</h4>
                        <button class="filter-close-btn" onclick="toggleFilterPanel('price')">‚úï</button>
                    </div>
                    <div class="filter-panel-content">
                        <div class="range-inputs">
                            <input type="number" id="price-min" class="range-input" placeholder="Min" value="0" onchange="applyFilters()">
                            <span class="range-dash">-</span>
                            <input type="number" id="price-max" class="range-input" placeholder="Max" value="999999" onchange="applyFilters()">
                        </div>
                        <input type="range" id="price-slider-min" class="slider" min="0" max="500000" value="0" oninput="updatePriceMin(this.value)">
                        <input type="range" id="price-slider-max" class="slider" min="0" max="500000" value="500000" oninput="updatePriceMax(this.value)">
                        <div class="slider-values">
                            <span>R<span id="price-display-min">0</span></span> - <span>R<span id="price-display-max">500000</span></span>
                        </div>
                    </div>
                </div>

                <!-- Kilometers Range Filter -->
                <div class="filter-panel-item" id="km-panel">
                    <div class="filter-panel-header">
                        <h4>Kilometers Range</h4>
                        <button class="filter-close-btn" onclick="toggleFilterPanel('km')">‚úï</button>
                    </div>
                    <div class="filter-panel-content">
                        <div class="range-inputs">
                            <input type="number" id="km-min" class="range-input" placeholder="Min" value="0" onchange="applyFilters()">
                            <span class="range-dash">-</span>
                            <input type="number" id="km-max" class="range-input" placeholder="Max" value="999999" onchange="applyFilters()">
                        </div>
                        <input type="range" id="km-slider-min" class="slider" min="0" max="500000" value="0" oninput="updateKmMin(this.value)">
                        <input type="range" id="km-slider-max" class="slider" min="0" max="500000" value="500000" oninput="updateKmMax(this.value)">
                        <div class="slider-values">
                            <span><span id="km-display-min">0</span> km</span> - <span><span id="km-display-max">500000</span> km</span>
                        </div>
                    </div>
                </div>

                <!-- Sort & Views Filter -->
                <div class="filter-panel-item" id="sort-panel">
                    <div class="filter-panel-header">
                        <h4>Sort By & Views</h4>
                        <button class="filter-close-btn" onclick="toggleFilterPanel('sort')">‚úï</button>
                    </div>
                    <div class="filter-panel-content">
                        <label class="filter-label-small">Sort By</label>
                        <select id="sort-select" class="filter-select" onchange="applyFilters()">
                            <option value="none">Default</option>
                            <option value="price-asc">Price: Low to High</option>
                            <option value="price-desc">Price: High to Low</option>
                            <option value="km-asc">Kilometers: Low to High</option>
                            <option value="km-desc">Kilometers: High to Low</option>
                            <option value="newest">Newest Listings First</option>
                        </select>
                        
                        <label class="filter-label-small" style="margin-top: 1.2em;">View By</label>
                        <div class="filter-checkboxes">
                            <label class="checkbox-label">
                                <input type="radio" name="view-type" value="bike" checked onchange="showView('bike')">
                                <span>By Bike Model</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="radio" name="view-type" value="source" onchange="showView('source')">
                                <span>By Source</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="radio" name="view-type" value="drops" onchange="showView('drops')">
                                <span>Price Drops Only</span>
                            </label>
                        </div>
                    </div>
                </div>

            <!-- Listings Area -->
            <div class="listings-area">
<div id="bike-view" class="view-container">
</div>
<div id="source-view" class="view-container hidden">
</div>
<div id="drops-view" class="view-container hidden">
</div>

            </div>

            <div class="timestamp">
                Last updated: 07/12/2025 03:57:58
            </div>
        </div>
    </section>

    <script>
        // Store all listings
        const allListings = [{"id": "gumtree_10013432943091013436132409", "title": "*SUPER RARE*  2019 Suzuki DL250X V-Strom", "price": "R 65,000", "price_history": [{"date": "01-12-2025 09:26:42", "price": "R 65,000"}], "url": "https://www.gumtree.co.za/a-motorcycles-scooters/hermanus/super-rare-2019-suzuki-dl250x-v+strom/10013432943091013436132409", "search_term": "Suzuki DS 250 SX V-STROM", "source": "Gumtree", "found_date": "07-12-2025 03:54:47", "kilometers": "28,000km", "location": "Hermanus", "price_dropped": false, "old_price": null}, {"id": "gumtree_10013429161411010930588509", "title": "Motorcycle Suzuki Gsx 250 f", "price": "R 16,000", "price_history": [{"date": "01-12-2025 09:26:42", "price": "R 16,000"}], "url": "https://www.gumtree.co.za/a-motorcycles-scooters/port-elizabeth/motorcycle-suzuki-gsx-250-f/10013429161411010930588509", "search_term": "Suzuki DS 250 SX V-STROM", "source": "Gumtree", "found_date": "07-12-2025 03:54:47", "kilometers": "9,250km", "location": "Port Elizabeth", "price_dropped": false, "old_price": null}, {"id": "gumtree_10013427327121013072243809", "title": "2007 Suzuki RMZ 250", "price": "R 26,000", "price_history": [{"date": "01-12-2025 09:26:42", "price": "R 26,000"}], "url": "https://www.gumtree.co.za/a-motorcycles-scooters/durbanville/2007-suzuki-rmz-250/10013427327121013072243809", "search_term": "Suzuki DS 250 SX V-STROM", "source": "Gumtree", "found_date": "07-12-2025 03:54:47", "kilometers": "1,000km", "location": "Durbanville", "price_dropped": false, "old_price": null}, {"id": "gumtree_10013415721851010183766509", "title": "Suzuki 250 V-Strom", "price": "R 54,900", "price_history": [{"date": "01-12-2025 09:26:42", "price": "R 54,900"}], "url": "https://www.gumtree.co.za/a-motorcycles-scooters/centurion/suzuki-250-v+strom/10013415721851010183766509", "search_term": "Suzuki DS 250 SX V-STROM", "source": "Gumtree", "found_date": "07-12-2025 03:54:47", "kilometers": "1,900km", "location": "Centurion", "price_dropped": false, "old_price": null}, {"id": "webuycars_7E9F13590", "title": "1997 Suzuki DS 80", "price": "R 15,900", "price_history": [{"date": "01-12-2025 09:26:36", "price": "N/A"}], "url": "https://www.webuycars.co.za/buy-a-car/Suzuki/DS/7E9F13590", "search_term": "Suzuki DS 250 SX V-STROM", "source": "WeBuyCars", "found_date": "07-12-2025 03:54:42", "kilometers": "N/A", "location": "Midstream (GP)", "price_dropped": false, "old_price": null}, {"id": "webuycars_457106339", "title": "2025 Suzuki 250 DS 250", "price": "R 49,900", "price_history": [{"date": "01-12-2025 09:26:36", "price": "R 49,900"}], "url": "https://www.webuycars.co.za/buy-a-car/Suzuki/250/457106339", "search_term": "Suzuki DS 250 SX V-STROM", "source": "WeBuyCars", "found_date": "07-12-2025 03:54:42", "kilometers": "1,632 km", "location": "Germiston (GP)", "price_dropped": false, "old_price": null}, {"id": "webuycars_F7C213165", "title": "2024 Suzuki 250 DS 250", "price": "R 50,900", "price_history": [{"date": "01-12-2025 09:26:36", "price": "R 53,900"}, {"date": "07-12-2025 03:57:58", "price": "R 50,900"}], "url": "https://www.webuycars.co.za/buy-a-car/Suzuki/250/F7C213165", "search_term": "Suzuki DS 250 SX V-STROM", "source": "WeBuyCars", "found_date": "07-12-2025 03:54:42", "kilometers": "2,500 km", "location": "Gqeberha (EC)", "price_dropped": true, "old_price": "R 53,900"}, {"id": "webuycars_2EEF08786", "title": "2023 Suzuki 250 DS 250", "price": "R 43,900", "price_history": [{"date": "01-12-2025 09:26:36", "price": "R 43,900"}], "url": "https://www.webuycars.co.za/buy-a-car/Suzuki/250/2EEF08786", "search_term": "Suzuki DS 250 SX V-STROM", "source": "WeBuyCars", "found_date": "07-12-2025 03:54:42", "kilometers": "5,370 km", "location": "Silver Lakes (GP)", "price_dropped": false, "old_price": null}, {"id": "webuycars_F6EB11634", "title": "2024 Suzuki 250 DS 250", "price": "R 49,900", "price_history": [{"date": "01-12-2025 09:26:36", "price": "R 49,900"}], "url": "https://www.webuycars.co.za/buy-a-car/Suzuki/250/F6EB11634", "search_term": "Suzuki DS 250 SX V-STROM", "source": "WeBuyCars", "found_date": "07-12-2025 03:54:42", "kilometers": "5,975 km", "location": "Dome (GP)", "price_dropped": false, "old_price": null}, {"id": "webuycars_74CA03829", "title": "2023 Suzuki 250 DS 250", "price": "R 46,900", "price_history": [{"date": "01-12-2025 09:26:36", "price": "R 49,900"}, {"date": "07-12-2025 03:57:58", "price": "R 46,900"}], "url": "https://www.webuycars.co.za/buy-a-car/Suzuki/250/74CA03829", "search_term": "Suzuki DS 250 SX V-STROM", "source": "WeBuyCars", "found_date": "07-12-2025 03:54:42", "kilometers": "8,090 km", "location": "Midstream (GP)", "price_dropped": true, "old_price": "R 49,900"}, {"id": "gumtree_10013320405561010354228509", "title": "Honda NX500", "price": "R 131,399", "price_history": [{"date": "01-12-2025 09:27:03", "price": "R 131,399"}], "url": "https://www.gumtree.co.za/a-motorcycles-scooters/pinetown/honda-nx500/10013320405561010354228509", "search_term": "Honda CB 500 X", "source": "Gumtree", "found_date": "07-12-2025 03:55:08", "kilometers": "1km", "location": "Pinetown", "price_dropped": false, "old_price": null}, {"id": "gumtree_10013318795501012895313109", "title": "2022 Honda CB500X", "price": "R 110,000", "price_history": [{"date": "01-12-2025 09:27:05", "price": "R 110,000"}], "url": "https://www.gumtree.co.za/a-motorcycles-scooters/pietermaritzburg/2022-honda-cb500x/10013318795501012895313109", "search_term": "Honda CB 500 X", "source": "Gumtree", "found_date": "07-12-2025 03:55:10", "kilometers": "8,403km", "location": "Pietermaritzburg", "price_dropped": false, "old_price": null}, {"id": "webuycars_513611610", "title": "2024 Honda CB 500 X", "price": "R 88,900", "price_history": [{"date": "01-12-2025 09:27:00", "price": "R 88,900"}], "url": "https://www.webuycars.co.za/buy-a-car/Honda/CB/513611610", "search_term": "Honda CB 500 X", "source": "WeBuyCars", "found_date": "07-12-2025 03:55:04", "kilometers": "11,502 km", "location": "Dome (GP)", "price_dropped": false, "old_price": null}, {"id": "webuycars_1DD500468", "title": "2012 Honda CBR 125r", "price": "R 22,900", "price_history": [{"date": "07-12-2025 03:55:04", "price": "R 22,900"}], "url": "https://www.webuycars.co.za/buy-a-car/Honda/CBR/1DD500468", "search_term": "Honda CB 500 X", "source": "WeBuyCars", "found_date": "07-12-2025 03:55:04", "kilometers": "21,688 km", "location": "Dome (GP)"}, {"id": "webuycars_834D12301", "title": "2012 Honda CBF 1000 F", "price": "R 55,900", "price_history": [{"date": "01-12-2025 09:27:00", "price": "R 55,900"}], "url": "https://www.webuycars.co.za/buy-a-car/Honda/CBF/834D12301", "search_term": "Honda CB 500 X", "source": "WeBuyCars", "found_date": "07-12-2025 03:55:04", "kilometers": "N/A", "location": "Gqeberha (EC)", "price_dropped": false, "old_price": null}, {"id": "webuycars_C65001852", "title": "2011 Honda CBR 600 RR", "price": "R 57,900", "price_history": [{"date": "07-12-2025 03:55:04", "price": "R 57,900"}], "url": "https://www.webuycars.co.za/buy-a-car/Honda/CBR/C65001852", "search_term": "Honda CB 500 X", "source": "WeBuyCars", "found_date": "07-12-2025 03:55:04", "kilometers": "14,900 km", "location": "Riverhorse (KZN)"}, {"id": "gumtree_10012465812701010354228509", "title": "2023 Kawasaki Ninja 400 SE ABS Demo", "price": "R 109,995", "price_history": [{"date": "01-12-2025 09:27:22", "price": "R 109,995"}], "url": "https://www.gumtree.co.za/a-motorcycles-scooters/pinetown/2023-kawasaki-ninja-400-se-abs-demo/10012465812701010354228509", "search_term": "Kawasaki Ninja 400", "source": "Gumtree", "found_date": "07-12-2025 03:55:24", "kilometers": "200km", "location": "Pinetown", "price_dropped": false, "old_price": null}, {"id": "webuycars_319C05189", "title": "2023 Kawasaki Ninja 650 (ex650m) ABS", "price": "R 91,900", "price_history": [{"date": "01-12-2025 09:27:21", "price": "R 91,900"}], "url": "https://www.webuycars.co.za/buy-a-car/Kawasaki/Ninja/319C05189", "search_term": "Kawasaki Ninja 400", "source": "WeBuyCars", "found_date": "07-12-2025 03:55:23", "kilometers": "17,000 km", "location": "Dome (GP)", "price_dropped": false, "old_price": null}, {"id": "webuycars_CDB401427", "title": "2010 Kawasaki Ninja 250 R", "price": "N/A", "price_history": [{"date": "07-12-2025 03:55:23", "price": "N/A"}], "url": "https://www.webuycars.co.za/buy-a-car/Kawasaki/Ninja/CDB401427", "search_term": "Kawasaki Ninja 400", "source": "WeBuyCars", "found_date": "07-12-2025 03:55:23", "kilometers": "46,539 km", "location": "East London (EC)"}, {"id": "webuycars_97BD12912", "title": "2019 Triumph Scrambler Street Scrambler", "price": "R 99,900", "price_history": [{"date": "01-12-2025 09:27:37", "price": "R 99,900"}], "url": "https://www.webuycars.co.za/buy-a-car/Triumph/Scrambler/97BD12912", "search_term": "Triumph Scrambler 400 x", "source": "WeBuyCars", "found_date": "07-12-2025 03:55:38", "kilometers": "16,469 km", "location": "East London (EC)", "price_dropped": false, "old_price": null}, {"id": "gumtree_10013424411931010005469309", "title": "Triumph speed twin 900", "price": "R 26,000", "price_history": [{"date": "01-12-2025 09:28:01", "price": "R 26,900"}, {"date": "07-12-2025 03:57:58", "price": "R 26,000"}], "url": "https://www.gumtree.co.za/a-motorcycles-scooters/george/triumph-speed-twin-900/10013424411931010005469309", "search_term": "Triumph Scrambler 900", "source": "Gumtree", "found_date": "07-12-2025 03:56:00", "kilometers": "1,000km", "location": "George", "price_dropped": true, "old_price": "R 26,900"}, {"id": "webuycars_97BD12912", "title": "2019 Triumph Scrambler Street Scrambler", "price": "R 99,900", "price_history": [{"date": "01-12-2025 09:27:58", "price": "R 99,900"}], "url": "https://www.webuycars.co.za/buy-a-car/Triumph/Scrambler/97BD12912", "search_term": "Triumph Scrambler 900", "source": "WeBuyCars", "found_date": "07-12-2025 03:55:57", "kilometers": "16,469 km", "location": "East London (EC)", "price_dropped": false, "old_price": null}, {"id": "webuycars_277907169", "title": "2011 Triumph Speed Triple 1050 ABS", "price": "N/A", "price_history": [{"date": "07-12-2025 03:56:12", "price": "N/A"}], "url": "https://www.webuycars.co.za/buy-a-car/Triumph/Speed Triple/277907169", "search_term": "Triumph Speed 400", "source": "WeBuyCars", "found_date": "07-12-2025 03:56:12", "kilometers": "55,635 km", "location": "Silver Lakes (GP)"}, {"id": "webuycars_E05B01946", "title": "2022 Triumph Speed Triple RS", "price": "R 189,900", "price_history": [{"date": "07-12-2025 03:56:12", "price": "R 189,900"}], "url": "https://www.webuycars.co.za/buy-a-car/Triumph/Speed Triple/E05B01946", "search_term": "Triumph Speed 400", "source": "WeBuyCars", "found_date": "07-12-2025 03:56:12", "kilometers": "17,155 km", "location": "Midstream (GP)"}, {"id": "gumtree_10013434854271013437147209", "title": "2012 Yamaha Raptor 700", "price": "R 129,500", "price_history": [{"date": "02-12-2025 09:05:21", "price": "R 129,500"}], "url": "https://www.gumtree.co.za/a-motorcycles-scooters/blouberg/2012-yamaha-raptor-700/10013434854271013437147209", "search_term": "yamaha xsr 700", "source": "Gumtree", "found_date": "07-12-2025 03:56:30", "kilometers": "123km", "location": "Blouberg", "price_dropped": false, "old_price": null}, {"id": "gumtree_10013430126281010001272009", "title": "Yamaha Raptor 700R", "price": "R 97,900", "price_history": [{"date": "01-12-2025 09:28:35", "price": "R 97,900"}], "url": "https://www.gumtree.co.za/a-motorcycles-scooters/kempton-park/yamaha-raptor-700r/10013430126281010001272009", "search_term": "yamaha xsr 700", "source": "Gumtree", "found_date": "07-12-2025 03:56:30", "kilometers": "2km", "location": "Kempton Park", "price_dropped": false, "old_price": null}, {"id": "gumtree_10013423932061012659766309", "title": "2006 Yamaha Raptor 700", "price": "R 78,000", "price_history": [{"date": "01-12-2025 09:28:35", "price": "R 78,000"}], "url": "https://www.gumtree.co.za/a-motorcycles-scooters/modimolle-nylstroom/2006-yamaha-raptor-700/10013423932061012659766309", "search_term": "yamaha xsr 700", "source": "Gumtree", "found_date": "07-12-2025 03:56:30", "kilometers": "10,000km", "location": "Modimolle / Nylstroom", "price_dropped": false, "old_price": null}, {"id": "gumtree_10013423044341010806790709", "title": "Yamaha Tenere 700", "price": "R 210,000", "price_history": [{"date": "01-12-2025 09:28:35", "price": "R 210,000"}], "url": "https://www.gumtree.co.za/a-motorcycles-scooters/gillitts/yamaha-tenere-700/10013423044341010806790709", "search_term": "yamaha xsr 700", "source": "Gumtree", "found_date": "07-12-2025 03:56:30", "kilometers": "3,100km", "location": "Gillitts", "price_dropped": false, "old_price": null}, {"id": "gumtree_10013434253351010003065109", "title": "Ducati Scrambler 800 Urban Enduro 2015", "price": "R 129,000", "price_history": [{"date": "02-12-2025 09:05:35", "price": "R 129,000"}], "url": "https://www.gumtree.co.za/a-motorcycles-scooters/other/ducati-scrambler-800-urban-enduro-2015/10013434253351010003065109", "search_term": "Ducati Scrambler", "source": "Gumtree", "found_date": "07-12-2025 03:56:44", "kilometers": "11,100km", "location": "Other", "price_dropped": false, "old_price": null}, {"id": "gumtree_10012503439581011067160209", "title": "2015 Ducati X Scrambler @Bike Bros Motorcycles!", "price": "R 124,500", "price_history": [{"date": "01-12-2025 09:28:50", "price": "R 124,500"}], "url": "https://www.gumtree.co.za/a-motorcycles-scooters/retreat/2015-ducati-x-scrambler-64-bike-bros-motorcycles/10012503439581011067160209", "search_term": "Ducati Scrambler", "source": "Gumtree", "found_date": "07-12-2025 03:56:44", "kilometers": "11,349km", "location": "Retreat", "price_dropped": false, "old_price": null}, {"id": "webuycars_D3D901140", "title": "2017 Ducati Scrambler Sixty2", "price": "R 63,900", "price_history": [{"date": "01-12-2025 09:28:49", "price": "R 63,900"}], "url": "https://www.webuycars.co.za/buy-a-car/Ducati/Scrambler/D3D901140", "search_term": "Ducati Scrambler", "source": "WeBuyCars", "found_date": "07-12-2025 03:56:43", "kilometers": "11,221 km", "location": "Richmond (WC)", "price_dropped": false, "old_price": null}, {"id": "webuycars_930609871", "title": "2016 Ducati Scrambler Urban Enduro", "price": "R 61,900", "price_history": [{"date": "01-12-2025 09:28:49", "price": "R 65,900"}, {"date": "07-12-2025 03:57:58", "price": "R 61,900"}], "url": "https://www.webuycars.co.za/buy-a-car/Ducati/Scrambler/930609871", "search_term": "Ducati Scrambler", "source": "WeBuyCars", "found_date": "07-12-2025 03:56:43", "kilometers": "23,488 km", "location": "Silver Lakes (GP)", "price_dropped": true, "old_price": "R 65,900"}, {"id": "gumtree_10013416804491010004286409", "title": "2025 Yamaha MT07 - MT 07 NEW", "price": "R 179,950", "price_history": [{"date": "01-12-2025 09:28:58", "price": "R 179,950"}], "url": "https://www.gumtree.co.za/a-motorcycles-scooters/kraaifontein/2025-yamaha-mt07-+-mt-07-new/10013416804491010004286409", "search_term": "Yamaha MT 07", "source": "Gumtree", "found_date": "07-12-2025 03:56:52", "kilometers": "N/A", "location": "Kraaifontein", "price_dropped": false, "old_price": null}, {"id": "webuycars_4F9108269", "title": "2018 Yamaha MT MT-09 Tracer", "price": "N/A", "price_history": [{"date": "07-12-2025 03:56:50", "price": "N/A"}], "url": "https://www.webuycars.co.za/buy-a-car/Yamaha/MT/4F9108269", "search_term": "Yamaha MT 07", "source": "WeBuyCars", "found_date": "07-12-2025 03:56:50", "kilometers": "11,998 km", "location": "Riverhorse (KZN)"}, {"id": "gumtree_10013432294351010054329109", "title": "2023 BMW 310 / 45 / G450", "price": "R 67,000", "price_history": [{"date": "01-12-2025 09:29:17", "price": "R 75,000"}, {"date": "07-12-2025 03:57:58", "price": "R 67,000"}], "url": "https://www.gumtree.co.za/a-motorcycles-scooters/benoni/2023-bmw-310-45-g450/10013432294351010054329109", "search_term": "BMW G 310", "source": "Gumtree", "found_date": "07-12-2025 03:57:09", "kilometers": "200km", "location": "Benoni", "price_dropped": true, "old_price": "R 75,000"}, {"id": "webuycars_9DB310327", "title": "2022 BMW G Series G 310 R", "price": "R 52,900", "price_history": [{"date": "01-12-2025 09:29:14", "price": "R 52,900"}], "url": "https://www.webuycars.co.za/buy-a-car/BMW/G Series/9DB310327", "search_term": "BMW G 310", "source": "WeBuyCars", "found_date": "07-12-2025 03:57:06", "kilometers": "22,490 km", "location": "Silver Lakes (GP)", "price_dropped": false, "old_price": null}, {"id": "webuycars_CAF414786", "title": "2014 BMW G Series G 650 GS Sertao ABS H/grips", "price": "R 43,900", "price_history": [{"date": "01-12-2025 09:29:14", "price": "N/A"}], "url": "https://www.webuycars.co.za/buy-a-car/BMW/G Series/CAF414786", "search_term": "BMW G 310", "source": "WeBuyCars", "found_date": "07-12-2025 03:57:06", "kilometers": "73,328 km", "location": "George (WC)", "price_dropped": false, "old_price": null}, {"id": "gumtree_10013402558801012478762009", "title": "2022 Bmw Gs 310 Rallye Limited Edition", "price": "R 55,500", "price_history": [{"date": "01-12-2025 09:29:32", "price": "R 55,500"}], "url": "https://www.gumtree.co.za/a-motorcycles-scooters/pietermaritzburg/2022-bmw-gs-310-rallye-limited-edition/10013402558801012478762009", "search_term": "BMW GS 310", "source": "Gumtree", "found_date": "07-12-2025 03:57:22", "kilometers": "8,500km", "location": "Pietermaritzburg", "price_dropped": false, "old_price": null}, {"id": "gumtree_10013432294351010054329109", "title": "2023 BMW 310 / 45 / G450", "price": "R 67,000", "price_history": [{"date": "01-12-2025 09:29:35", "price": "R 75,000"}, {"date": "07-12-2025 03:57:58", "price": "R 67,000"}], "url": "https://www.gumtree.co.za/a-motorcycles-scooters/benoni/2023-bmw-310-45-g450/10013432294351010054329109", "search_term": "BMW GS 310", "source": "Gumtree", "found_date": "07-12-2025 03:57:24", "kilometers": "200km", "location": "Benoni", "price_dropped": true, "old_price": "R 75,000"}, {"id": "gumtree_10012465812701010354228509", "title": "2023 Kawasaki Ninja 400 SE ABS Demo", "price": "R 109,995", "price_history": [{"date": "01-12-2025 09:29:50", "price": "R 109,995"}], "url": "https://www.gumtree.co.za/a-motorcycles-scooters/pinetown/2023-kawasaki-ninja-400-se-abs-demo/10012465812701010354228509", "search_term": "Kawasaki Z 400", "source": "Gumtree", "found_date": "07-12-2025 03:57:40", "kilometers": "200km", "location": "Pinetown", "price_dropped": false, "old_price": null}, {"id": "webuycars_173402446", "title": "2008 Kawasaki ZX Zx10-R", "price": "N/A", "price_history": [{"date": "07-12-2025 03:57:37", "price": "N/A"}], "url": "https://www.webuycars.co.za/buy-a-car/Kawasaki/ZX/173402446", "search_term": "Kawasaki Z 400", "source": "WeBuyCars", "found_date": "07-12-2025 03:57:37", "kilometers": "18,401 km", "location": "Gqeberha (EC)"}, {"id": "webuycars_031302389", "title": "2022 Kawasaki Z 900 ABS (zr900f)", "price": "R 144,900", "price_history": [{"date": "01-12-2025 09:29:47", "price": "R 149,900"}, {"date": "07-12-2025 03:57:58", "price": "R 144,900"}], "url": "https://www.webuycars.co.za/buy-a-car/Kawasaki/Z 900/031302389", "search_term": "Kawasaki Z 400", "source": "WeBuyCars", "found_date": "07-12-2025 03:57:37", "kilometers": "10,732 km", "location": "Dome (GP)", "price_dropped": true, "old_price": "R 149,900"}];
        let filteredListings = [...allListings];

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            applyFilters();
        });

        function showView(viewType) {
            document.querySelectorAll('.view-container').forEach(el => el.classList.add('hidden'));
            document.getElementById(viewType + '-view').classList.remove('hidden');
            document.querySelector(`input[name="view-type"][value="${viewType}"]`).checked = true;
            applyFilters();
        }

        function toggleFilterPanel(panelType) {
            const panelId = panelType + '-panel';
            const panel = document.getElementById(panelId);
            const isOpen = panel.classList.contains('open');
            
            // Close all panels
            document.querySelectorAll('.filter-panel-item').forEach(p => p.classList.remove('open'));
            
            // Open clicked panel if it was closed
            if (!isOpen) {
                panel.classList.add('open');
            }
        }

        function updatePriceMin(value) {
            document.getElementById('price-min').value = value;
            document.getElementById('price-display-min').textContent = parseInt(value).toLocaleString();
            applyFilters();
        }

        function updatePriceMax(value) {
            document.getElementById('price-max').value = value;
            document.getElementById('price-display-max').textContent = parseInt(value).toLocaleString();
            applyFilters();
        }

        function updateKmMin(value) {
            document.getElementById('km-min').value = value;
            document.getElementById('km-display-min').textContent = parseInt(value).toLocaleString();
            applyFilters();
        }

        function updateKmMax(value) {
            document.getElementById('km-max').value = value;
            document.getElementById('km-display-max').textContent = parseInt(value).toLocaleString();
            applyFilters();
        }

        function applyFilters() {
            // Get filter values
            const selectedSources = Array.from(document.querySelectorAll('.source-checkbox:checked')).map(cb => cb.value);
            const priceMin = parseInt(document.getElementById('price-min').value) || 0;
            const priceMax = parseInt(document.getElementById('price-max').value) || 999999;
            const kmMin = parseInt(document.getElementById('km-min').value) || 0;
            const kmMax = parseInt(document.getElementById('km-max').value) || 999999;
            const sortBy = document.getElementById('sort-select').value;

            // Filter listings
            filteredListings = allListings.filter(listing => {
                // Check source
                if (!selectedSources.includes(listing.source)) return false;

                // Parse price (remove R and spaces)
                const priceStr = listing.price.replace(/[R\s,]/g, '');
                const price = parseInt(priceStr) || 0;
                if (price < priceMin || price > priceMax) return false;

                // Parse kilometers
                let km = 0;
                const kmStr = listing.kilometers.replace(/[km\s,]/g, '');
                if (kmStr && !isNaN(kmStr)) {
                    km = parseInt(kmStr);
                }
                if (km < kmMin || km > kmMax) return false;

                return true;
            });

            // Sort listings
            if (sortBy === 'price-asc') {
                filteredListings.sort((a, b) => {
                    const priceA = parseInt(a.price.replace(/[R\s,]/g, '')) || 0;
                    const priceB = parseInt(b.price.replace(/[R\s,]/g, '')) || 0;
                    return priceA - priceB;
                });
            } else if (sortBy === 'price-desc') {
                filteredListings.sort((a, b) => {
                    const priceA = parseInt(a.price.replace(/[R\s,]/g, '')) || 0;
                    const priceB = parseInt(b.price.replace(/[R\s,]/g, '')) || 0;
                    return priceB - priceA;
                });
            } else if (sortBy === 'km-asc') {
                filteredListings.sort((a, b) => {
                    const kmA = parseInt(a.kilometers.replace(/[km\s,]/g, '')) || 0;
                    const kmB = parseInt(b.kilometers.replace(/[km\s,]/g, '')) || 0;
                    return kmA - kmB;
                });
            } else if (sortBy === 'km-desc') {
                filteredListings.sort((a, b) => {
                    const kmA = parseInt(a.kilometers.replace(/[km\s,]/g, '')) || 0;
                    const kmB = parseInt(b.kilometers.replace(/[km\s,]/g, '')) || 0;
                    return kmB - kmA;
                });
            }

            // Update display
            updateTableDisplay();
            document.getElementById('filtered-count').textContent = filteredListings.length;
        }

        function clearAllFilters() {
            // Reset checkboxes
            document.querySelectorAll('.source-checkbox').forEach(cb => cb.checked = true);
            
            // Reset price range
            document.getElementById('price-min').value = 0;
            document.getElementById('price-max').value = 500000;
            document.getElementById('price-slider-min').value = 0;
            document.getElementById('price-slider-max').value = 500000;
            document.getElementById('price-display-min').textContent = '0';
            document.getElementById('price-display-max').textContent = '500000';
            
            // Reset km range
            document.getElementById('km-min').value = 0;
            document.getElementById('km-max').value = 500000;
            document.getElementById('km-slider-min').value = 0;
            document.getElementById('km-slider-max').value = 500000;
            document.getElementById('km-display-min').textContent = '0';
            document.getElementById('km-display-max').textContent = '500000';
            
            // Reset sort
            document.getElementById('sort-select').value = 'none';
            
            // Close all filter panels
            document.querySelectorAll('.filter-panel-item').forEach(p => p.classList.remove('open'));
            
            applyFilters();
        }

        function updateTableDisplay() {
            // Get active view
            const activeView = document.querySelector('.view-container:not(.hidden)');
            const viewType = activeView?.id.replace('-view', '') || 'bike';

            if (viewType === 'bike') {
                updateBikeView();
            } else if (viewType === 'source') {
                updateSourceView();
            } else if (viewType === 'drops') {
                updateDropsView();
            }
        }

        function updateBikeView() {
            const container = document.getElementById('bike-view');
            
            // Group filtered listings by bike
            const byBike = {};
            filteredListings.forEach(listing => {
                const bike = listing.search_term;
                if (!byBike[bike]) byBike[bike] = [];
                byBike[bike].push(listing);
            });

            container.innerHTML = '';
            if (Object.keys(byBike).length === 0) {
                container.innerHTML = '<div class="no-listings"><p>No listings match your filters.</p></div>';
                return;
            }

            for (const [bike, listings] of Object.entries(byBike)) {
                container.innerHTML += generateTableSection(bike, listings, 'bike');
            }
        }

        function updateSourceView() {
            const container = document.getElementById('source-view');
            
            // Group filtered listings by source
            const bySource = {};
            filteredListings.forEach(listing => {
                const source = listing.source;
                if (!bySource[source]) bySource[source] = [];
                bySource[source].push(listing);
            });

            container.innerHTML = '';
            if (Object.keys(bySource).length === 0) {
                container.innerHTML = '<div class="no-listings"><p>No listings match your filters.</p></div>';
                return;
            }

            for (const [source, listings] of Object.entries(bySource)) {
                container.innerHTML += generateTableSection(source, listings, 'source');
            }
        }

        function updateDropsView() {
            const container = document.getElementById('drops-view');
            const drops = filteredListings.filter(l => l.price_dropped);

            container.innerHTML = '';
            if (drops.length === 0) {
                container.innerHTML = '<div class="no-listings"><p>No price drops match your filters.</p></div>';
                return;
            }

            container.innerHTML += generateDropsTable(drops);
        }

        function generateTableSection(title, listings, type) {
            let html = `
                <div class="table-section">
                    <div class="table-header">
                        <h2>${title}</h2>
                        <span class="listing-count">${listings.length} listing(s)</span>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>${type === 'bike' ? 'Source' : 'Bike Model'}</th>
                                <th>Title</th>
                                <th>Price</th>
                                <th>Kilometers</th>
                                <th>Location</th>
                                <th>Link</th>
                            </tr>
                        </thead>
                        <tbody>
            `;

            listings.forEach(listing => {
                const priceDisplay = listing.price_dropped && listing.old_price
                    ? `<span class='old-price'>${listing.old_price}</span> ${listing.price}`
                    : listing.price;

                html += `
                    <tr class="${listing.price_dropped ? 'price-drop-row' : ''}">
                        <td class="bike-name">${type === 'bike' ? listing.source : listing.search_term}</td>
                        <td class="bike-name">${listing.title}</td>
                        <td class="price">${priceDisplay}</td>
                        <td class="kilometers">${listing.kilometers}</td>
                        <td class="location">${listing.location}</td>
                        <td><a href="${listing.url}" target="_blank" class="view-link">View ‚Üí</a></td>
                    </tr>
                `;
            });

            html += `
                        </tbody>
                    </table>
                </div>
            `;
            return html;
        }

        function generateDropsTable(listings) {
            let html = `
                <div class="table-section">
                    <div class="table-header">
                        <h2>Price Drops Detected</h2>
                        <span class="listing-count">${listings.length} listing(s) with price drops</span>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Bike Model</th>
                                <th>Title</th>
                                <th>Price</th>
                                <th>Kilometers</th>
                                <th>Location</th>
                                <th>Source</th>
                                <th>Link</th>
                            </tr>
                        </thead>
                        <tbody>
            `;

            listings.forEach(listing => {
                const priceDisplay = listing.old_price
                    ? `<span class='old-price'>${listing.old_price}</span> ${listing.price}`
                    : listing.price;

                html += `
                    <tr class="price-drop-row">
                        <td class="bike-name">${listing.search_term}</td>
                        <td class="bike-name">${listing.title}</td>
                        <td class="price">${priceDisplay}</td>
                        <td class="kilometers">${listing.kilometers}</td>
                        <td class="location">${listing.location}</td>
                        <td class="source">${listing.source}</td>
                        <td><a href="${listing.url}" target="_blank" class="view-link">View ‚Üí</a></td>
                    </tr>
                `;
            });

            html += `
                        </tbody>
                    </table>
                </div>
            `;
            return html;
        }
    </script>
</body>

</html>
